<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>НаборДанных1</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Серия</dataPath>
			<field>Серия</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Характеристика</dataPath>
			<field>Характеристика</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Назначение</dataPath>
			<field>Назначение</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Склад</dataPath>
			<field>Склад</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтатусДокумента</dataPath>
			<field>СтатусДокумента</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Помещение</dataPath>
			<field>Помещение</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РемонтОборудования</dataPath>
			<field>РемонтОборудования</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаИзмененияСтатусаЗапланировано</dataPath>
			<field>ДатаИзмененияСтатусаЗапланировано</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата изменения статуса запланировано</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВРаботе</dataPath>
			<field>КоличествоВРаботе</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество в работе</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Ответственный</dataPath>
			<field>Ответственный</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Ответственный</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаНачалаРаботПланФакт</dataPath>
			<field>ДатаНачалаРаботПланФакт</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата начала работ план факт</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаОкончанияРабот</dataPath>
			<field>ДатаОкончанияРабот</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОтгрузкаПоСлужебнойЗаписке</dataPath>
			<field>ОтгрузкаПоСлужебнойЗаписке</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Отгрузка по служебной записке</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаОкончанияРаботПланФакт</dataPath>
			<field>ДатаОкончанияРаботПланФакт</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата окончания работ план факт</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НачалоГрафик</dataPath>
			<field>НачалоГрафик</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Начало график</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КонецГрафик</dataPath>
			<field>КонецГрафик</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Конец график</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаРегистрации</dataPath>
			<field>ДатаРегистрации</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата регистрации</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НачалоФакт</dataPath>
			<field>НачалоФакт</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Начало факт</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаИзмененияСтатусаОтложено</dataPath>
			<field>ДатаИзмененияСтатусаОтложено</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата изменения статуса отложено</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерАкта</dataPath>
			<field>НомерАкта</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номер акта</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КонецФакт</dataPath>
			<field>КонецФакт</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Конец факт</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаДокумента</dataPath>
			<field>ДатаДокумента</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата документа</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Артикул</dataPath>
			<field>Артикул</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Артикул</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоОформлено</dataPath>
			<field>КоличествоОформлено</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество оформлено</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НомерДокумента</dataPath>
			<field>НомерДокумента</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номер документа</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Организация</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаАкта</dataPath>
			<field>ДатаАкта</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата акта</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаправлениеДеятельности</dataPath>
			<field>НаправлениеДеятельности</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Направление деятельности</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Причина</dataPath>
			<field>Причина</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Причина</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоЗавершено</dataPath>
			<field>КоличествоЗавершено</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество завершено</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаИзмененияСтатусаЗавершено</dataPath>
			<field>ДатаИзмененияСтатусаЗавершено</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата изменения статуса завершено</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВключенВГрафикРемонта</dataPath>
			<field>ВключенВГрафикРемонта</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Включен в график ремонта</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Регистратор</dataPath>
			<field>Регистратор</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Описание</dataPath>
			<field>Описание</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Описание</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Приоритет</dataPath>
			<field>Приоритет</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Приоритет</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВНаличии</dataPath>
			<field>ВНаличии</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>В наличии</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаИзмененияСтатусаВРаботе</dataPath>
			<field>ДатаИзмененияСтатусаВРаботе</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата изменения статуса в работе</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТребуетсяЗаказЗапчасти</dataPath>
			<field>ТребуетсяЗаказЗапчасти</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Требуется заказ запчасти</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Период1</dataPath>
			<field>Период1</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Период1</v8:content>
				</v8:item>
			</title>
			<useRestriction>
				<field>true</field>
				<condition>true</condition>
				<group>true</group>
				<order>true</order>
			</useRestriction>
			<role>
				<dcscom:required>true</dcscom:required>
			</role>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаНачалаГрафик КАК ДатаНачалаРаботПланФакт,
	КАМИ_РемонтОборудованияОбороты.Регистратор.ТребуетсяЗаказЗапчасти КАК ТребуетсяЗаказЗапчасти,
	ВЫБОР
		КОГДА КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаКонецГрафик = ДАТАВРЕМЯ(1, 1, 1)
			ТОГДА КОНЕЦПЕРИОДА(КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаНачалаГрафик, ДЕНЬ)
		ИНАЧЕ КОНЕЦПЕРИОДА(КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаКонецГрафик, ДЕНЬ)
	КОНЕЦ КАК ДатаОкончанияРаботПланФакт,
	КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаНачалаГрафик КАК НачалоГрафик,
	ВЫБОР
		КОГДА КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаКонецГрафик = ДАТАВРЕМЯ(1, 1, 1)
			ТОГДА КОНЕЦПЕРИОДА(КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаНачалаГрафик, ДЕНЬ)
		ИНАЧЕ КОНЕЦПЕРИОДА(КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаКонецГрафик, ДЕНЬ)
	КОНЕЦ КАК КонецГрафик,
	КАМИ_РемонтОборудованияОбороты.Регистратор.Дата КАК ДатаРегистрации,
	КАМИ_РемонтОборудованияОбороты.Регистратор.ОтветственныйЗаУчасток КАК Ответственный,
	КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаНачалаФакт КАК НачалоФакт,
	КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаКонецФакт КАК КонецФакт,
	КАМИ_РемонтОборудованияОбороты.Регистратор.Дата КАК ДатаДокумента,
	КАМИ_РемонтОборудованияОбороты.Номенклатура.Артикул КАК Артикул,
	КАМИ_РемонтОборудованияОбороты.Номенклатура КАК Номенклатура,
	КАМИ_РемонтОборудованияОбороты.Серия КАК Серия,
	ВЫБОР
		КОГДА КАМИ_РемонтОборудованияОбороты.Статус = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.Запланировано)
				ИЛИ КАМИ_РемонтОборудованияОбороты.Статус = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.Отложено)
			ТОГДА КАМИ_РемонтОборудованияОбороты.Количество
		ИНАЧЕ 0
	КОНЕЦ КАК КоличествоОформлено,
	КАМИ_РемонтОборудованияОбороты.Регистратор.НомерАкта КАК НомерАкта,
	КАМИ_РемонтОборудованияОбороты.Регистратор.Номер КАК НомерДокумента,
	КАМИ_РемонтОборудованияОбороты.Регистратор.ДатаАкта КАК ДатаАкта,
	КАМИ_РемонтОборудованияОбороты.Характеристика КАК Характеристика,
	КАМИ_РемонтОборудованияОбороты.Назначение КАК Назначение,
	КАМИ_РемонтОборудованияОбороты.Склад КАК Склад,
	КАМИ_РемонтОборудованияОбороты.Регистратор.Организация КАК Организация,
	КАМИ_РемонтОборудованияОбороты.Регистратор.НаправлениеДеятельности КАК НаправлениеДеятельности,
	КАМИ_РемонтОборудованияОбороты.Регистратор.Причина КАК Причина,
	ВЫБОР
		КОГДА КАМИ_РемонтОборудованияОбороты.Статус = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.ВРаботе)
			ТОГДА КАМИ_РемонтОборудованияОбороты.Количество
		ИНАЧЕ 0
	КОНЕЦ КАК КоличествоВРаботе,
	КАМИ_РемонтОборудованияОбороты.Статус КАК СтатусДокумента,
	ВЫБОР
		КОГДА КАМИ_РемонтОборудованияОбороты.Статус = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.Завершено)
			ТОГДА КАМИ_РемонтОборудованияОбороты.Количество
		ИНАЧЕ 0
	КОНЕЦ КАК КоличествоЗавершено,
	КАМИ_РемонтОборудованияОбороты.Регистратор КАК Регистратор,
	ВЫРАЗИТЬ(КАМИ_РемонтОборудованияОбороты.Регистратор.Описание КАК СТРОКА(200)) КАК Описание,
	КАМИ_РемонтОборудованияОбороты.Регистратор.ОтгрузкаПоСлужебнойЗаписке КАК ОтгрузкаПоСлужебнойЗаписке,
	КАМИ_РемонтОборудованияОбороты.Регистратор.ВключенВГрафикРемонта КАК ВключенВГрафикРемонта,
	КАМИ_СтатусыРемонтаСрезПоследнихЗапланировано.Период КАК ДатаИзмененияСтатусаЗапланировано,
	КАМИ_РемонтОборудованияОбороты.Регистратор.Приоритет КАК Приоритет,
	КАМИ_СтатусыРемонтаТекущийСрез.ДатаОкончанияРабот КАК ДатаОкончанияРабот,
	ЕСТЬNULL(ТоварыНаСкладахОстатки.ВНаличииОстаток, 0) + ЕСТЬNULL(ТоварыНаСкладахОстатки.КОтгрузкеОстаток, 0) &gt; 0 КАК ВНаличии
ПОМЕСТИТЬ Вт_ОсновнаяТаблицаРемонтов
ИЗ
	РегистрСведений.КАМИ_РемонтОборудованияРС КАК КАМИ_РемонтОборудованияОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КАМИ_СтатусыРемонта.СрезПоследних({(&amp;ДатаОтчета)}, СтатусДокумента = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.Запланировано)) КАК КАМИ_СтатусыРемонтаСрезПоследнихЗапланировано
		ПО КАМИ_РемонтОборудованияОбороты.Регистратор = КАМИ_СтатусыРемонтаСрезПоследнихЗапланировано.РемонтОборудования
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.КАМИ_СтатусыРемонта.СрезПоследних({(&amp;ДатаОтчета)}, ) КАК КАМИ_СтатусыРемонтаТекущийСрез
		ПО КАМИ_РемонтОборудованияОбороты.Регистратор = КАМИ_СтатусыРемонтаТекущийСрез.РемонтОборудования
			И КАМИ_РемонтОборудованияОбороты.Регистратор.Статус = КАМИ_СтатусыРемонтаТекущийСрез.СтатусДокумента
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ТоварыНаСкладах.Остатки({(&amp;ДатаОтчета)}, ) КАК ТоварыНаСкладахОстатки
		ПО КАМИ_РемонтОборудованияОбороты.Характеристика = ТоварыНаСкладахОстатки.Характеристика
			И КАМИ_РемонтОборудованияОбороты.Номенклатура = ТоварыНаСкладахОстатки.Номенклатура
			И КАМИ_РемонтОборудованияОбороты.Серия = ТоварыНаСкладахОстатки.Серия
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	КАМИ_СтатусыРемонта.Период КАК Период,
	КАМИ_СтатусыРемонта.РемонтОборудования КАК РемонтОборудования,
	КАМИ_СтатусыРемонта.СтатусДокумента КАК СтатусДокумента,
	МАКСИМУМ(КАМИ_СтатусыРемонта1.Период) КАК Период1
ПОМЕСТИТЬ ВТ_СтатусыРемонтаБлижайшиеЗаписи
ИЗ
	РегистрСведений.КАМИ_СтатусыРемонта КАК КАМИ_СтатусыРемонта
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КАМИ_РемонтОборудования КАК КАМИ_РемонтОборудования
		ПО КАМИ_СтатусыРемонта.РемонтОборудования = КАМИ_РемонтОборудования.Ссылка
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.КАМИ_СтатусыРемонта КАК КАМИ_СтатусыРемонта1
		ПО КАМИ_СтатусыРемонта.РемонтОборудования = КАМИ_СтатусыРемонта1.РемонтОборудования
			И КАМИ_СтатусыРемонта.Период &gt; КАМИ_СтатусыРемонта1.Период
			И КАМИ_СтатусыРемонта.СтатусДокумента &lt;&gt; КАМИ_СтатусыРемонта1.СтатусДокумента
ГДЕ
	КАМИ_РемонтОборудования.Ссылка В
			(ВЫБРАТЬ
				Вт_ОсновнаяТаблицаРемонтов.Регистратор
			ИЗ
				Вт_ОсновнаяТаблицаРемонтов)

СГРУППИРОВАТЬ ПО
	КАМИ_СтатусыРемонта.Период,
	КАМИ_СтатусыРемонта.РемонтОборудования,
	КАМИ_СтатусыРемонта.СтатусДокумента

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	МИНИМУМ(КАМИ_СтатусыРемонта.Период),
	КАМИ_СтатусыРемонта.РемонтОборудования,
	КАМИ_СтатусыРемонта.СтатусДокумента,
	МИНИМУМ(КАМИ_СтатусыРемонта.Период)
ИЗ
	РегистрСведений.КАМИ_СтатусыРемонта КАК КАМИ_СтатусыРемонта
ГДЕ
	КАМИ_СтатусыРемонта.РемонтОборудования В
			(ВЫБРАТЬ
				Вт_ОсновнаяТаблицаРемонтов.Регистратор
			ИЗ
				Вт_ОсновнаяТаблицаРемонтов)

СГРУППИРОВАТЬ ПО
	КАМИ_СтатусыРемонта.РемонтОборудования,
	КАМИ_СтатусыРемонта.СтатусДокумента
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МИНИМУМ(ВТ_СтатусыРемонтаБлижайшиеЗаписи.Период) КАК Период,
	ВТ_СтатусыРемонтаБлижайшиеЗаписи.РемонтОборудования КАК РемонтОборудования,
	ВТ_СтатусыРемонтаБлижайшиеЗаписи.СтатусДокумента КАК СтатусДокумента,
	ВТ_СтатусыРемонтаБлижайшиеЗаписи.Период1 КАК Период1
ПОМЕСТИТЬ ВТ_ПервыеЗаписиВГруппе
ИЗ
	ВТ_СтатусыРемонтаБлижайшиеЗаписи КАК ВТ_СтатусыРемонтаБлижайшиеЗаписи

СГРУППИРОВАТЬ ПО
	ВТ_СтатусыРемонтаБлижайшиеЗаписи.Период1,
	ВТ_СтатусыРемонтаБлижайшиеЗаписи.РемонтОборудования,
	ВТ_СтатусыРемонтаБлижайшиеЗаписи.СтатусДокумента
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МАКСИМУМ(ВТ_ПервыеЗаписиВГруппе.Период) КАК Период,
	ВТ_ПервыеЗаписиВГруппе.РемонтОборудования КАК РемонтОборудования,
	ВТ_ПервыеЗаписиВГруппе.СтатусДокумента КАК СтатусДокумента,
	МАКСИМУМ(ВТ_ПервыеЗаписиВГруппе.Период1) КАК Период1
ПОМЕСТИТЬ ВТ_СрезПоследнихПоПервымЗаписямВГруппе
ИЗ
	ВТ_ПервыеЗаписиВГруппе КАК ВТ_ПервыеЗаписиВГруппе

СГРУППИРОВАТЬ ПО
	ВТ_ПервыеЗаписиВГруппе.СтатусДокумента,
	ВТ_ПервыеЗаписиВГруппе.РемонтОборудования
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Вт_ОсновнаяТаблицаРемонтов.ДатаНачалаРаботПланФакт КАК ДатаНачалаРаботПланФакт,
	Вт_ОсновнаяТаблицаРемонтов.ДатаОкончанияРаботПланФакт КАК ДатаОкончанияРаботПланФакт,
	Вт_ОсновнаяТаблицаРемонтов.НачалоГрафик КАК НачалоГрафик,
	Вт_ОсновнаяТаблицаРемонтов.КонецГрафик КАК КонецГрафик,
	Вт_ОсновнаяТаблицаРемонтов.ДатаРегистрации КАК ДатаРегистрации,
	Вт_ОсновнаяТаблицаРемонтов.Ответственный КАК Ответственный,
	Вт_ОсновнаяТаблицаРемонтов.НачалоФакт КАК НачалоФакт,
	Вт_ОсновнаяТаблицаРемонтов.КонецФакт КАК КонецФакт,
	Вт_ОсновнаяТаблицаРемонтов.ДатаДокумента КАК ДатаДокумента,
	Вт_ОсновнаяТаблицаРемонтов.Артикул КАК Артикул,
	Вт_ОсновнаяТаблицаРемонтов.Номенклатура КАК Номенклатура,
	Вт_ОсновнаяТаблицаРемонтов.Серия КАК Серия,
	Вт_ОсновнаяТаблицаРемонтов.КоличествоОформлено КАК КоличествоОформлено,
	Вт_ОсновнаяТаблицаРемонтов.НомерАкта КАК НомерАкта,
	Вт_ОсновнаяТаблицаРемонтов.НомерДокумента КАК НомерДокумента,
	Вт_ОсновнаяТаблицаРемонтов.ДатаАкта КАК ДатаАкта,
	Вт_ОсновнаяТаблицаРемонтов.Характеристика КАК Характеристика,
	Вт_ОсновнаяТаблицаРемонтов.Назначение КАК Назначение,
	Вт_ОсновнаяТаблицаРемонтов.Склад КАК Склад,
	Вт_ОсновнаяТаблицаРемонтов.Организация КАК Организация,
	Вт_ОсновнаяТаблицаРемонтов.НаправлениеДеятельности КАК НаправлениеДеятельности,
	Вт_ОсновнаяТаблицаРемонтов.Причина КАК Причина,
	Вт_ОсновнаяТаблицаРемонтов.КоличествоВРаботе КАК КоличествоВРаботе,
	Вт_ОсновнаяТаблицаРемонтов.СтатусДокумента КАК СтатусДокумента,
	Вт_ОсновнаяТаблицаРемонтов.КоличествоЗавершено КАК КоличествоЗавершено,
	Вт_ОсновнаяТаблицаРемонтов.Регистратор КАК Регистратор,
	Вт_ОсновнаяТаблицаРемонтов.ТребуетсяЗаказЗапчасти КАК ТребуетсяЗаказЗапчасти,
	Вт_ОсновнаяТаблицаРемонтов.Описание КАК Описание,
	Вт_ОсновнаяТаблицаРемонтов.ОтгрузкаПоСлужебнойЗаписке КАК ОтгрузкаПоСлужебнойЗаписке,
	Вт_ОсновнаяТаблицаРемонтов.ВключенВГрафикРемонта КАК ВключенВГрафикРемонта,
	Вт_ОсновнаяТаблицаРемонтов.ДатаИзмененияСтатусаЗапланировано КАК ДатаИзмененияСтатусаЗапланировано,
	Вт_ОсновнаяТаблицаРемонтов.Приоритет КАК Приоритет,
	Вт_ОсновнаяТаблицаРемонтов.ДатаОкончанияРабот КАК ДатаОкончанияРабот,
	Вт_ОсновнаяТаблицаРемонтов.ВНаличии КАК ВНаличии,
	ВТ_СрезПоследнихПоПервымЗаписямВГруппеВРаботе.Период КАК ДатаИзмененияСтатусаВРаботе,
	ВТ_СрезПоследнихПоПервымЗаписямВГруппеОтложено.Период КАК ДатаИзмененияСтатусаОтложено,
	ВТ_СрезПоследнихПоПервымЗаписямВГруппеЗавершено.Период КАК ДатаИзмененияСтатусаЗавершено,
	ВТ_СрезПоследнихПоПервымЗаписямВГруппеВРаботе.Период1 КАК Период1
ИЗ
	Вт_ОсновнаяТаблицаРемонтов КАК Вт_ОсновнаяТаблицаРемонтов
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СрезПоследнихПоПервымЗаписямВГруппе КАК ВТ_СрезПоследнихПоПервымЗаписямВГруппеВРаботе
		ПО Вт_ОсновнаяТаблицаРемонтов.Регистратор = ВТ_СрезПоследнихПоПервымЗаписямВГруппеВРаботе.РемонтОборудования
			И (ВТ_СрезПоследнихПоПервымЗаписямВГруппеВРаботе.СтатусДокумента = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.Вработе))
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СрезПоследнихПоПервымЗаписямВГруппе КАК ВТ_СрезПоследнихПоПервымЗаписямВГруппеЗавершено
		ПО Вт_ОсновнаяТаблицаРемонтов.Регистратор = ВТ_СрезПоследнихПоПервымЗаписямВГруппеЗавершено.РемонтОборудования
			И (ВТ_СрезПоследнихПоПервымЗаписямВГруппеЗавершено.СтатусДокумента = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.Завершено))
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_СрезПоследнихПоПервымЗаписямВГруппе КАК ВТ_СрезПоследнихПоПервымЗаписямВГруппеОтложено
		ПО Вт_ОсновнаяТаблицаРемонтов.Регистратор = ВТ_СрезПоследнихПоПервымЗаписямВГруппеОтложено.РемонтОборудования
			И (ВТ_СрезПоследнихПоПервымЗаписямВГруппеОтложено.СтатусДокумента = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.Отложено))
ГДЕ
	ВЫБОР
			КОГДА &amp;УстановленПериод
					И Вт_ОсновнаяТаблицаРемонтов.СтатусДокумента = ЗНАЧЕНИЕ(Перечисление.КАМИ_СтатусыСервисныхРабот.Завершено)
				ТОГДА ВТ_СрезПоследнихПоПервымЗаписямВГруппеЗавершено.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода
			ИНАЧЕ ИСТИНА
		КОНЕЦ</query>
	</dataSet>
	<parameter>
		<name>ДатаОтчета</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Дата отчета</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>УстановленПериод</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Установлен период</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Артикул</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ВключенВГрафикРемонта</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ВНаличии</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаАкта</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаДокумента</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаИзмененияСтатусаВРаботе</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаИзмененияСтатусаЗавершено</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаИзмененияСтатусаЗапланировано</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаИзмененияСтатусаОтложено</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаНачалаРаботПланФакт</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаОкончанияРабот</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаОкончанияРаботПланФакт</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаРегистрации</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>КоличествоВРаботе</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>КоличествоЗавершено</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>КоличествоОформлено</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>КонецГрафик</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>КонецФакт</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Назначение</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>НаправлениеДеятельности</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>НачалоГрафик</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>НачалоФакт</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Номенклатура</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>НомерАкта</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>НомерДокумента</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Описание</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Организация</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Ответственный</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОтгрузкаПоСлужебнойЗаписке</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Приоритет</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Причина</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Регистратор</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Серия</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Склад</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>СтатусДокумента</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Характеристика</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ТребуетсяЗаказЗапчасти</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:item xsi:type="dcsset:StructureItemGroup">
				<dcsset:order>
					<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
				</dcsset:order>
				<dcsset:selection>
					<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
				</dcsset:selection>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>